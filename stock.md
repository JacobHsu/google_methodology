---
description: 如何確定起始的日期和終止的日期？
---

# 股票最長的增長期

假如有個預言家能告訴你哪天開始買入股票，哪天賣出，你就能最大地獲益。從上面的數據可以看出，你應該在第5天買入，在第10天賣出，這樣你的累計有效增長就比股指高出52.4個基本點。在此之前和之後，持有ABC公司的股票都不如持有指數基金。

在實際的股票交易中，思科公司和英特爾公司的股票，最佳的持有區間是從它們上市一直持有到2000年的某一天，再往後，持有它們的股票就不如持有標普500指數或者道瓊斯指數了。這個最長點增長期，是一個投資人所能最大獲益的上限，通常沒有人能夠捕捉得那麼準確，但是上述的區間，對於股票研究還是有意義的，它可以作為分母來衡量投資人的表現。  
  
接下來Google的問題是，

## 如何確定起始的日期和終止的日期？

對於這道問題，有四種可行的方法，它們計算的複雜度從高到低依次下降。

### 方法一，做一次三重循環

其實就是中學裡學的排列組合的方法。我們先假設一共有K天。

如果起始和終止日期能夠確定，從起始日到終止日，做一次連加，就算出某個特定的起始日到終止日之間股票的有效漲幅，這是一重循環。當然起始日可以是第一天到第K天中的任意一天，這是第二重循環。終止日也可以有這麼多選擇（當然終止日要不早於起始日），這是第三重循環。於是起始和終止日本身就有KxK／2種選擇。每一種選擇最多要做K次加法（最少做零次），平均做K／2次。

_因此這種方法的複雜度是O（K^3），即K的三次方。_

這個方法無疑能夠完成任務，但是做了太多的無用功。如果遇上GE這樣的百年老店，數據有幾萬個點，幾萬的三次方可是幾十萬億，計算量非常大。

### 方法二，做兩重循環

在上述方法中，我們可以看到這樣一個現象：對於某個特定的起始日期，比如從第500天開始，我們想知道終止日期設在第1000天好呢，還是第1001天更好。這件事很簡單，只要看看第1001天的有效漲幅是正的，還是負的就可以了。如果是正的，那麼顯然要持有到1001天，因為多漲了一天，這時，我們要把累計到第1001天的漲幅記錄下來，但是到第1000天的累計漲幅其實後面不會再用到了，就可以刪掉了。

相反，如果1001天的漲幅是負的，那並不能說明股票從此就該拋掉，因為第1002天、第1003天……都還有機會大漲。在這種情況下，要保留截止到第1000天的累計增幅，然後再往後一直看，直到有一天，累計增幅超過它，才可以把累計到第1000天的數據刪掉，用新的累計增幅替代它。這樣一來，設定一個初始日期，掃瞄一遍，就能找到從這個起始日期開始，到哪一天結束，累計的增幅最大。這個過程需要K次加法和K次比較。

_由於起始日期還不確定，它可以是從第一天到最後一天（第K天）中間的任何一天，因此要試K次，於是這種算法的複雜度是O（K^2）。_

如果K有好幾萬，計算量是十幾億，比前一種方法已經減少了上萬倍。

### 方法三，分治算法的應用

它和方法二的關係，就如同過去介紹的歸併排序和冒泡排序的關係。

更具體一點講，就是把股票漲跌的時間從中間一分為二，變成兩個階段，而兩個小問題加起來也要比一個大問題簡單些。然後你再把兩個小問題分成四個更小的問題，直到分不下去為止。最後這個方法的複雜度可以降到O（N x Log N），對於GE這樣有幾萬天交易記錄的公司，計算量為百萬左右，這比十幾億又小了上千倍。

### 方法四，正反兩遍掃瞄的方法

這個方法也是對方法二的改進。在方法二中，我們其實能夠找到股票從此走下坡路的時間，比如我們能知道在第1005天之後，股票的累計漲幅達到了頂點，再往後雖然有漲有跌，但累計下來沒有增長，因此就不用考慮了，這一天就定為截止日期，或者說拋售的日期。但是，我無法知道股票在什麼時候開始進入上升期的。因此在方法二中我們假設了所有的情況都是合理的。

然而，如果我們能夠逆向思考這個問題，從最後一天往前回溯，用同樣的辦法，就能找到股票上升期的開始日期。這兩個日期之間就是該購買和持有ABC公司股票的時間段。

_第四種算法只要掃瞄兩遍數據，就能解決所有的問題，其複雜度是O（N），也就是說是線性的。_

對於GE這樣有幾萬天交易的股票，計算量只有幾萬而已，比上一種方法又快了幾十倍。

從方法一到方法四，我們將一個問題的計算量從幾十萬億，降低到幾萬。平庸的方法和好的方法差距如此之大。

最後總結一下

首先，計算機科學中經常會遇到的量級的差別。

其次，在金融上，任何一隻股票都有跑不贏大盤的時候，因為任何公司最終會消亡。道瓊斯最早的12只成分股公司和隨後的20個公司，今天只剩下GE一家了。而且如果不出意外，GE的股票從此也很難再跑贏大盤了。因此，玩單只股票其實是很危險的事情。

當然，最關鍵的是，逆向思維永遠重要。

